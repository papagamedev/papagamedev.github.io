{%- if site.comments_enabled and page.comments_enabled -%}  
  <script src="/js/jquery-3.7.1.min.js" type="text/javascript"></script>
  <script type="text/javascript">
    (function ($) {
    $('#new_comment').submit(function () {
      var form = this;

      $(form).addClass('disabled');
      $('#comment-form-submit').html('<i class="fas fa-spinner fa-spin fa-fw"></i> Cargando...');

      $.ajax({
        type: $(this).attr('method'),
        url: $(this).attr('action'),
        data: $(this).serialize(),
        contentType: 'application/x-www-form-urlencoded',
        success: function (data) {
          $('#comment-form-submit').html('Enviado');
          $('.comment-form .js-notice').removeClass('notice-error');
          $('.comment-form .js-notice').addClass('notice-success');
          showAlert('¡Gracias por el comentario! Aparecerá en la página una vez sea aprobado.');
        },
        error: function (err) {
          console.log(err);
          $('#comment-form-submit').html('Enviar Comentario');
          $('.comment-form .js-notice').removeClass('notice-success');
          $('.comment-form .js-notice').addClass('notice-error');
          showAlert('Lamentablemente hubo un error al enviar el comentario. Por favor verifica que los campos requeridos hayan sido completados e intenta nuevamente.');
          $(form).removeClass('disabled');
        }
      });

      return false;
    });

    function showAlert(message) {
      $('.comment-form .js-notice').removeClass('hidden');
      $('.comment-form .js-notice-text').html(message);
    }
  })(jQuery);
  </script>
{% endif %}
